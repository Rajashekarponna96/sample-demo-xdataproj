"use strict";(self.webpackChunkapollo_ng=self.webpackChunkapollo_ng||[]).push([[743],{743:(oe,_,l)=>{l.r(_),l.d(_,{MessagesModule:()=>se});var h=l(6895),T=l(9965),e=l(8256),O=l(1135),p=l(529);let v=(()=>{class n{constructor(t){this.http=t,this._activeUser={id:1,name:"Ioni Bowcher",image:"ionibowcher.png",status:"active",messages:[{text:"Lorem ipsum dolor sit amet, consectetur adipiscing elit",ownerId:1,createdAt:1652646338240},{text:"Sed do eiusmod tempor incididunt ut labore et dolore magna aliqua",ownerId:1,createdAt:1652646368718},{text:"Sed do eiusmod tempor incididunt ut labore et dolore magna aliqua",ownerId:123,createdAt:1652646368718}],lastSeen:"2d"},this.activeUser=new O.X(this._activeUser),this.activeUser$=this.activeUser.asObservable()}getChatData(){return this.http.get("assets/demo/data/chat.json").toPromise().then(t=>t.data).then(t=>t)}changeActiveChat(t){this._activeUser=t,this.activeUser.next(t)}sendMessage(t){this._activeUser.messages.push(t),this.activeUser.next(this._activeUser)}}return n.\u0275fac=function(t){return new(t||n)(e.LFG(p.eN))},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac}),n})();var y=l(1146),C=l(5593),f=l(4361),d=l(805);let k=(()=>{class n{constructor(t){this.http=t}fetchLatestRecipients(t){let s=f.t.loginObject,o=new p.WM;o=o.append("Content-Type","application/json; charset=utf-8").append("authorization","Basic "+btoa(s.accountid+":"+s.endpoint+":"+s.token+":"+s.schema+":"+s.database));let r=JSON.stringify(t);console.log("POSTDATA",r);let a=new p.LE;return a=a.append("postdata",r),this.http.get("https://"+s.appurl+"/unifund/AuthLatestReceiverList",{headers:o,params:a})}}return n.\u0275fac=function(t){return new(t||n)(e.LFG(p.eN))},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();var x=l(1740),g=l(433),M=l(2861);const Z=function(n,i){return{"bg-green-400":n,"bg-red-400":i,"bg-yellow-400":"away"}};let L=(()=>{class n{constructor(t,s){this.chatService=t,this.eventService=s}ngOnInit(){console.log("USER",this.user)}changeView(t){console.log("USER",t),this.eventService.emit(new M.n("MessageClicked",t))}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(v),e.Y36(y.G))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-user-card"]],inputs:{user:"user"},decls:12,vars:8,consts:[["tabindex","0",1,"w-full","flex","flex-nowrap","justify-content-between","align-items-center","border-1","surface-border","border-round","p-1","cursor-pointer","select-none","hover:surface-hover","transition-colors","transition-duration-150",3,"keydown.enter","click"],[1,"w-full","flex","align-items-center"],[1,"mr-3"],["alt","user",1,"w-3rem","h-3rem","border-circle","shadow-4",3,"src"],[1,"w-1rem","h-1rem","border-circle","border-2","surface-border","absolute",2,"bottom","2px","right","2px",3,"ngClass"],[1,"w-full","flex","flex-column"],[1,"text-900","font-semibold","block"],[1,"text-600","text-overflow-ellipsis","overflow-hidden","white-space-nowrap","text-sm"],[1,"text-900","text-overflow-ellipsis","overflow-hidden","white-space-nowrap","text-sm"]],template:function(t,s){1&t&&(e.TgZ(0,"div",0),e.NdJ("keydown.enter",function(){return s.changeView(s.user)})("click",function(){return s.changeView(s.user)}),e.TgZ(1,"div",1)(2,"div",2),e._UZ(3,"img",3)(4,"span",4),e.qZA(),e.TgZ(5,"div",5)(6,"span",6),e._uU(7),e.qZA(),e.TgZ(8,"span",7),e._uU(9),e.qZA(),e.TgZ(10,"span",8),e._uU(11),e.qZA()()()()),2&t&&(e.xp6(3),e.MGl("src","assets/demo/images/avatar/",s.user.image,"",e.LSH),e.xp6(1),e.Q6J("ngClass",e.WLB(5,Z,"active"===s.user.status,"busy"===s.user.status)),e.xp6(3),e.Oqu(s.user.name),e.xp6(2),e.Oqu(s.user.entitycontent.names[0].name),e.xp6(2),e.Oqu(s.user.entitycontent.names[0].name))},dependencies:[h.mk],encapsulation:2}),n})();function A(n,i){1&n&&e._UZ(0,"app-user-card",9),2&n&&e.Q6J("user",i.$implicit)}let P=(()=>{class n{constructor(t,s,o){this.chatService=t,this.messageService=s,this.http=o,this.searchValue="",this.users=[],this.filteredUsers=[],this.GlobalConstants=f.t}ngOnInit(){console.log("HELLO"),console.log("GLOBAL",this.GlobalConstants.loginObject),this.loadRecipients(f.t.loginObject)}filter(){let t=[];for(let s=0;s<this.users.length;s++){let o=this.users[s];0==o.name.toLowerCase().indexOf(this.searchValue.toLowerCase())&&t.push(o)}this.filteredUsers=[...t]}loadRecipients(t){let s=new k(this.http),o={lo:this.GlobalConstants.loginObject,offset:0};console.log("CRITERIA",o),this._ahlSub=s.fetchLatestRecipients(o).subscribe({complete:()=>{console.info("complete")},error:r=>{},next:r=>{if(console.log("NEXT",r),!r.hasOwnProperty("error")){if(r.hasOwnProperty("success")){let a=r;return console.log("FRESH PEOPLE",a.success),this.users=a.success.recipients,this.filteredUsers=a.success.recipients,this.GlobalConstants.loginObject.xetamainperson=a.success.xetamainperson,void console.log("FINAL LO",this.GlobalConstants.loginObject)}return null==r?void this.showErrorViaToast("A null object has been returned. An undefined error has occurred."):(this.showErrorViaToast("An undefined error has occurred."),!1)}this.showErrorViaToast(r.error)}})}showInfoViaToast(){this.messageService.add({key:"tst",severity:"info",summary:"Info Message",detail:"PrimeNG rocks"})}showWarnViaToast(){this.messageService.add({key:"tst",severity:"warn",summary:"Warn Message",detail:"There are unsaved changes"})}showErrorViaToast(t){this.messageService.add({key:"tst",severity:"error",summary:"Error Message",detail:t})}showSuccessViaToast(){this.messageService.add({key:"tst",severity:"success",summary:"Success Message",detail:"Message sent"})}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(v),e.Y36(d.ez),e.Y36(p.eN))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-chat-sidebar"]],features:[e._Bn([d.YP,d.ez])],decls:10,vars:3,consts:[[1,"flex","flex-column","align-items-center","border-bottom-1","surface-border","p-1"],["src","assets/demo/images/avatar/circl/avatar-f-1@2x.png","alt","",1,"w-6rem","h-6rem","border-circle","shadow-4"],[1,"text-900","text-xl","font-semibold","mt-2"],[1,"w-full","flex","row-gap-4","flex-column","surface-border","p-2"],[1,"p-input-icon-left","w-full"],[1,"pi","pi-search"],["id","search","type","text","pInputText","","placeholder","Search",1,"w-full",3,"ngModel","ngModelChange","input"],[1,"w-full","flex","flex-row","md:flex-column","overflow-auto"],[3,"user",4,"ngFor","ngForOf"],[3,"user"]],template:function(t,s){1&t&&(e.TgZ(0,"div",0),e._UZ(1,"img",1),e.TgZ(2,"span",2),e._uU(3),e.qZA()(),e.TgZ(4,"div",3)(5,"span",4),e._UZ(6,"i",5),e.TgZ(7,"input",6),e.NdJ("ngModelChange",function(r){return s.searchValue=r})("input",function(){return s.filter()}),e.qZA()(),e.TgZ(8,"div",7),e.YNc(9,A,1,1,"app-user-card",8),e.qZA()()),2&t&&(e.xp6(3),e.Oqu(s.GlobalConstants.loginObject.accounthead),e.xp6(4),e.Q6J("ngModel",s.searchValue),e.xp6(2),e.Q6J("ngForOf",s.filteredUsers))},dependencies:[h.sg,x.o,g.Fj,g.JJ,g.On,L],encapsulation:2}),n})(),I=(()=>{class n{constructor(t){this.http=t}fetchMessageList(t){let s=f.t.loginObject,o=new p.WM;o=o.append("Content-Type","application/json; charset=utf-8").append("authorization","Basic "+btoa(s.accountid+":"+s.endpoint+":"+s.token+":"+s.schema+":"+s.database));let r=JSON.stringify(t);console.log("POSTDATA",r);let a=new p.LE;return a=a.append("postdata",r),this.http.get("https://"+s.appurl+"/unifund/AuthMessageList",{headers:o,params:a})}}return n.\u0275fac=function(t){return new(t||n)(e.LFG(p.eN))},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),E=(()=>{class n{constructor(t){this.http=t}sendMessage(t){let s=f.t.loginObject,o=new p.WM;o=o.append("Content-Type","application/json; charset=utf-8").append("authorization","Basic "+btoa(s.accountid+":"+s.endpoint+":"+s.token+":"+s.schema+":"+s.database));let r=JSON.stringify(t),a=new p.LE;return a=a.append("postdata",r),this.http.put("https://"+s.appurl+"/unifund/AuthSendMessage",r,{headers:o})}}return n.\u0275fac=function(t){return new(t||n)(e.LFG(p.eN))},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();var u=l(7340),m=l(9592),S=l(1795),w=l(982);function j(n,i){1&n&&e.GkF(0)}function B(n,i){if(1&n){const t=e.EpF();e.TgZ(0,"button",5),e.NdJ("click",function(o){e.CHM(t);const r=e.oxw(2);return e.KtG(r.onCloseClick(o))})("keydown.enter",function(){e.CHM(t);const o=e.oxw(2);return e.KtG(o.hide())}),e._UZ(1,"span",6),e.qZA()}if(2&n){const t=e.oxw(2);e.uIk("aria-label",t.ariaCloseLabel)}}const R=function(n,i){return{showTransitionParams:n,hideTransitionParams:i}},U=function(n,i){return{value:n,params:i}};function F(n,i){if(1&n){const t=e.EpF();e.TgZ(0,"div",1),e.NdJ("click",function(o){e.CHM(t);const r=e.oxw();return e.KtG(r.onOverlayClick(o))})("@animation.start",function(o){e.CHM(t);const r=e.oxw();return e.KtG(r.onAnimationStart(o))})("@animation.done",function(o){e.CHM(t);const r=e.oxw();return e.KtG(r.onAnimationEnd(o))}),e.TgZ(1,"div",2),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.onContentClick())})("mousedown",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.onContentClick())}),e.Hsn(2),e.YNc(3,j,1,0,"ng-container",3),e.qZA(),e.YNc(4,B,2,1,"button",4),e.qZA()}if(2&n){const t=e.oxw();e.Tol(t.styleClass),e.Q6J("ngClass","p-overlaypanel p-component")("ngStyle",t.style)("@animation",e.WLB(10,U,t.overlayVisible?"open":"close",e.WLB(7,R,t.showTransitionOptions,t.hideTransitionOptions))),e.xp6(3),e.Q6J("ngTemplateOutlet",t.contentTemplate),e.xp6(1),e.Q6J("ngIf",t.showCloseIcon)}}const G=["*"];let J=(()=>{class n{constructor(t,s,o,r,a,c){this.el=t,this.renderer=s,this.cd=o,this.zone=r,this.config=a,this.overlayService=c,this.dismissable=!0,this.appendTo="body",this.autoZIndex=!0,this.baseZIndex=0,this.focusOnShow=!0,this.showTransitionOptions=".12s cubic-bezier(0, 0, 0.2, 1)",this.hideTransitionOptions=".1s linear",this.onShow=new e.vpe,this.onHide=new e.vpe,this.overlayVisible=!1,this.render=!1,this.isOverlayAnimationInProgress=!1,this.selfClick=!1}ngAfterContentInit(){this.templates.forEach(t=>{t.getType(),this.contentTemplate=t.template,this.cd.markForCheck()})}bindDocumentClickListener(){!this.documentClickListener&&this.dismissable&&this.zone.runOutsideAngular(()=>{let t=m.p.isIOS()?"touchstart":"click";this.documentClickListener=this.renderer.listen(this.el?this.el.nativeElement.ownerDocument:"document",t,o=>{!this.container.contains(o.target)&&this.target!==o.target&&!this.target.contains(o.target)&&!this.selfClick&&this.zone.run(()=>{this.hide()}),this.selfClick=!1,this.cd.markForCheck()})})}unbindDocumentClickListener(){this.documentClickListener&&(this.documentClickListener(),this.documentClickListener=null,this.selfClick=!1)}toggle(t,s){this.isOverlayAnimationInProgress||(this.overlayVisible?(this.hasTargetChanged(t,s)&&(this.destroyCallback=()=>{this.show(null,s||t.currentTarget||t.target)}),this.hide()):this.show(t,s))}show(t,s){this.isOverlayAnimationInProgress||(this.target=s||t.currentTarget||t.target,this.overlayVisible=!0,this.render=!0,this.cd.markForCheck())}onOverlayClick(t){this.overlayService.add({originalEvent:t,target:this.el.nativeElement}),this.selfClick=!0}onContentClick(){this.selfClick=!0}hasTargetChanged(t,s){return null!=this.target&&this.target!==(s||t.currentTarget||t.target)}appendContainer(){this.appendTo&&("body"===this.appendTo?document.body.appendChild(this.container):m.p.appendChild(this.container,this.appendTo))}restoreAppend(){this.container&&this.appendTo&&this.el.nativeElement.appendChild(this.container)}align(){this.autoZIndex&&w.P9.set("overlay",this.container,this.baseZIndex+this.config.zIndex.overlay),m.p.absolutePosition(this.container,this.target);const t=m.p.getOffset(this.container),s=m.p.getOffset(this.target);let o=0;t.left<s.left&&(o=s.left-t.left),this.container.style.setProperty("--overlayArrowLeft",`${o}px`),t.top<s.top&&(m.p.addClass(this.container,"p-overlaypanel-flipped"),this.showCloseIcon&&(this.container.style.marginTop="30px"))}onAnimationStart(t){"open"===t.toState&&(this.container=t.element,this.appendContainer(),this.align(),this.bindDocumentClickListener(),this.bindDocumentResizeListener(),this.bindScrollListener(),this.focusOnShow&&this.focus(),this.overlayEventListener=s=>{this.container&&this.container.contains(s.target)&&(this.selfClick=!0)},this.overlaySubscription=this.overlayService.clickObservable.subscribe(this.overlayEventListener),this.onShow.emit(null)),this.isOverlayAnimationInProgress=!0}onAnimationEnd(t){switch(t.toState){case"void":this.destroyCallback&&(this.destroyCallback(),this.destroyCallback=null),this.overlaySubscription&&this.overlaySubscription.unsubscribe();break;case"close":this.autoZIndex&&w.P9.clear(this.container),this.overlaySubscription&&this.overlaySubscription.unsubscribe(),this.onContainerDestroy(),this.onHide.emit({}),this.render=!1}this.isOverlayAnimationInProgress=!1}focus(){let t=m.p.findSingle(this.container,"[autofocus]");t&&this.zone.runOutsideAngular(()=>{setTimeout(()=>t.focus(),5)})}hide(){this.overlayVisible=!1,this.cd.markForCheck()}onCloseClick(t){this.hide(),t.preventDefault()}onWindowResize(t){this.overlayVisible&&!m.p.isTouchDevice()&&this.hide()}bindDocumentResizeListener(){this.documentResizeListener=this.onWindowResize.bind(this),window.addEventListener("resize",this.documentResizeListener)}unbindDocumentResizeListener(){this.documentResizeListener&&(window.removeEventListener("resize",this.documentResizeListener),this.documentResizeListener=null)}bindScrollListener(){this.scrollHandler||(this.scrollHandler=new m.V(this.target,()=>{this.overlayVisible&&this.hide()})),this.scrollHandler.bindScrollListener()}unbindScrollListener(){this.scrollHandler&&this.scrollHandler.unbindScrollListener()}onContainerDestroy(){this.cd.destroyed||(this.target=null),this.unbindDocumentClickListener(),this.unbindDocumentResizeListener(),this.unbindScrollListener()}ngOnDestroy(){this.scrollHandler&&(this.scrollHandler.destroy(),this.scrollHandler=null),this.container&&this.autoZIndex&&w.P9.clear(this.container),this.cd.destroyed||(this.target=null),this.destroyCallback=null,this.container&&(this.restoreAppend(),this.onContainerDestroy()),this.overlaySubscription&&this.overlaySubscription.unsubscribe()}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.SBq),e.Y36(e.Qsj),e.Y36(e.sBO),e.Y36(e.R0b),e.Y36(d.b4),e.Y36(d.F0))},n.\u0275cmp=e.Xpm({type:n,selectors:[["p-overlayPanel"]],contentQueries:function(t,s,o){if(1&t&&e.Suo(o,d.jx,4),2&t){let r;e.iGM(r=e.CRH())&&(s.templates=r)}},hostAttrs:[1,"p-element"],inputs:{dismissable:"dismissable",showCloseIcon:"showCloseIcon",style:"style",styleClass:"styleClass",appendTo:"appendTo",autoZIndex:"autoZIndex",ariaCloseLabel:"ariaCloseLabel",baseZIndex:"baseZIndex",focusOnShow:"focusOnShow",showTransitionOptions:"showTransitionOptions",hideTransitionOptions:"hideTransitionOptions"},outputs:{onShow:"onShow",onHide:"onHide"},ngContentSelectors:G,decls:1,vars:1,consts:[[3,"ngClass","ngStyle","class","click",4,"ngIf"],[3,"ngClass","ngStyle","click"],[1,"p-overlaypanel-content",3,"click","mousedown"],[4,"ngTemplateOutlet"],["type","button","class","p-overlaypanel-close p-link","pRipple","",3,"click","keydown.enter",4,"ngIf"],["type","button","pRipple","",1,"p-overlaypanel-close","p-link",3,"click","keydown.enter"],[1,"p-overlaypanel-close-icon","pi","pi-times"]],template:function(t,s){1&t&&(e.F$t(),e.YNc(0,F,5,13,"div",0)),2&t&&e.Q6J("ngIf",s.render)},dependencies:[h.mk,h.O5,h.tP,h.PC,S.H],styles:['.p-overlaypanel{position:absolute;margin-top:10px;top:0;left:0}.p-overlaypanel-flipped{margin-top:0;margin-bottom:10px}.p-overlaypanel-close{display:flex;justify-content:center;align-items:center;overflow:hidden;position:relative}.p-overlaypanel:after,.p-overlaypanel:before{bottom:100%;left:calc(var(--overlayArrowLeft, 0) + 1.25rem);content:" ";height:0;width:0;position:absolute;pointer-events:none}.p-overlaypanel:after{border-width:8px;margin-left:-8px}.p-overlaypanel:before{border-width:10px;margin-left:-10px}.p-overlaypanel-shifted:after,.p-overlaypanel-shifted:before{left:auto;right:1.25em;margin-left:auto}.p-overlaypanel-flipped:after,.p-overlaypanel-flipped:before{bottom:auto;top:100%}.p-overlaypanel.p-overlaypanel-flipped:after{border-bottom-color:transparent}.p-overlaypanel.p-overlaypanel-flipped:before{border-bottom-color:transparent}\n'],encapsulation:2,data:{animation:[(0,u.X$)("animation",[(0,u.SB)("void",(0,u.oB)({transform:"scaleY(0.8)",opacity:0})),(0,u.SB)("close",(0,u.oB)({opacity:0})),(0,u.SB)("open",(0,u.oB)({transform:"translateY(0)",opacity:1})),(0,u.eR)("void => open",(0,u.jt)("{{showTransitionParams}}")),(0,u.eR)("open => close",(0,u.jt)("{{hideTransitionParams}}"))])]},changeDetection:0}),n})(),N=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[h.ez,S.T,d.m8,d.m8]}),n})();function z(n,i){if(1&n&&(e.TgZ(0,"div",23)(1,"div",24),e._UZ(2,"img",25),e.qZA(),e.TgZ(3,"div",26)(4,"p",27),e._uU(5),e.qZA(),e.TgZ(6,"span",28),e._uU(7),e.qZA(),e.TgZ(8,"p",29),e._uU(9),e._UZ(10,"i",30),e.qZA()()()),2&n){const t=e.oxw().$implicit,s=e.oxw();e.xp6(5),e.Oqu(s.xetaperson.name),e.xp6(2),e.Oqu(t.body),e.xp6(2),e.Oqu(s.parseDate(t.timezone))}}function D(n,i){if(1&n&&(e.TgZ(0,"div",23)(1,"div",31)(2,"span",32),e._uU(3),e.qZA(),e.TgZ(4,"p",29),e._uU(5),e._UZ(6,"i",30),e.qZA()()()),2&n){const t=e.oxw().$implicit,s=e.oxw();e.xp6(3),e.Oqu(t.body),e.xp6(2),e.hij("",s.parseDate(t.timezone)," ")}}function V(n,i){if(1&n&&(e.TgZ(0,"div"),e.YNc(1,z,11,3,"div",22),e.YNc(2,D,7,2,"div",22),e.qZA()),2&n){const t=i.$implicit;e.xp6(1),e.Q6J("ngIf","TO"===t.direction),e.xp6(1),e.Q6J("ngIf","FROM"===t.direction)}}function Y(n,i){if(1&n){const t=e.EpF();e.TgZ(0,"button",34),e.NdJ("click",function(){const r=e.CHM(t).$implicit,a=e.oxw(2);return e.MAs(23).hide(),e.KtG(a.onEmojiSelect(r))}),e.qZA()}2&n&&e.Q6J("label",i.$implicit)}function H(n,i){if(1&n&&e.YNc(0,Y,1,1,"button",33),2&n){const t=e.oxw();e.Q6J("ngForOf",t.emojis)}}let q=(()=>{class n{constructor(t,s,o,r,a){this.changeDetectorRef=t,this.chatService=s,this.eventService=o,this.http=r,this.messageService=a,this.textContent="",this.uploadedFiles=[],this.emojis=["\u{1f600}","\u{1f603}","\u{1f604}","\u{1f601}","\u{1f606}","\u{1f605}","\u{1f602}","\u{1f923}","\u{1f607}","\u{1f609}","\u{1f60a}","\u{1f642}","\u{1f643}","\u{1f60b}","\u{1f60c}","\u{1f60d}","\u{1f970}","\u{1f618}","\u{1f617}","\u{1f619}","\u{1f61a}","\u{1f92a}","\u{1f61c}","\u{1f61d}","\u{1f61b}","\u{1f911}","\u{1f60e}","\u{1f913}","\u{1f9d0}","\u{1f920}","\u{1f973}","\u{1f917}","\u{1f921}","\u{1f60f}","\u{1f636}","\u{1f610}","\u{1f611}","\u{1f612}","\u{1f644}","\u{1f928}","\u{1f914}","\u{1f92b}","\u{1f92d}","\u{1f925}","\u{1f633}","\u{1f61e}","\u{1f61f}","\u{1f620}","\u{1f621}","\u{1f92c}","\u{1f614}","\u{1f61f}","\u{1f620}","\u{1f621}","\u{1f92c}","\u{1f614}","\u{1f615}","\u{1f641}","\u{1f62c}","\u{1f97a}","\u{1f623}","\u{1f616}","\u{1f62b}","\u{1f629}","\u{1f971}","\u{1f624}","\u{1f62e}","\u{1f631}","\u{1f628}","\u{1f630}","\u{1f62f}","\u{1f626}","\u{1f627}","\u{1f622}","\u{1f625}","\u{1f62a}","\u{1f924}"],this.GlobalConstants=f.t,this.messageList=[],this.items=[{id:1,name:"Item 1"},{id:2,name:"Item 2"},{id:3,name:"Item 3"}],this.strucattachs=[],this.files=[]}setMessage(){}ngOnInit(){this.xetaperson={name:""},this.eventService.on("MessageClicked",t=>{console.log("MSG CLICK",t),this.xetaperson=t;let s={appurl:this.GlobalConstants.loginObject.appurl,database:this.GlobalConstants.loginObject.database,schema:this.GlobalConstants.loginObject.schema,accountid:this.GlobalConstants.loginObject.accountid,timezone:this.GlobalConstants.loginObject.timezone};console.log("LO",JSON.stringify(s)),console.log("XP",JSON.stringify(this.xetaperson)),console.log("PREV PERSON",typeof this.prevPerson),(typeof this.prevPerson>"u"||this.prevPerson.id!==this.xetaperson.id)&&this.loadMessageList(s,this.xetaperson,0)})}sendMessage(){if(""!=this.textContent&&" "!==this.textContent){let t=[],s=[];t.push(this.GlobalConstants.loginObject.xetamainperson),s.push(this.xetaperson);let o={from:t,to:s,subject:"",body:this.textContent,strucattachs:this.strucattachs,files:this.files};console.log("SEND MSG",JSON.stringify(o)),this.sendMessageTo(o),this.textContent=""}}onEmojiSelect(t){this.textContent+=t}parseDate(t){return new Date(t).toTimeString().split(":").slice(0,2).join(":")}trackByFn(t,s){return s.xetamail}sendMessageTo(t){let s=new E(this.http);this._ahlSub=s.sendMessage(t).subscribe({complete:()=>{console.info("complete")},error:o=>{},next:o=>{if(console.log("NEXT",o),!o.hasOwnProperty("error")){if(o.hasOwnProperty("success")){console.log("SEND MSG",o.success);let a={appurl:this.GlobalConstants.loginObject.appurl,database:this.GlobalConstants.loginObject.database,schema:this.GlobalConstants.loginObject.schema,accountid:this.GlobalConstants.loginObject.accountid,timezone:this.GlobalConstants.loginObject.timezone};return console.log("LO",JSON.stringify(a)),console.log("XP",JSON.stringify(this.xetaperson)),void this.loadMessageList(a,this.xetaperson,0)}return null==o?void this.showErrorViaToast("A null object has been returned. An undefined error has occurred."):(this.showErrorViaToast("An undefined error has occurred."),!1)}this.showErrorViaToast(o.error)}})}loadMessageList(t,s,o){let r=new I(this.http),a={lo:t,xetaperson:s,offset:o};console.log("CRITERIA",a),this._ahlSub=r.fetchMessageList(a).subscribe({complete:()=>{console.info("complete")},error:c=>{},next:c=>{if(console.log("NEXT",c),!c.hasOwnProperty("error")){if(c.hasOwnProperty("success")){let b=c;return console.log("MESSAGE LIST",b.success),this.messageList=b.success,this.changeDetectorRef.detectChanges(),void(this.prevPerson=JSON.parse(JSON.stringify(this.xetaperson)))}return null==c?void this.showErrorViaToast("A null object has been returned. An undefined error has occurred."):(this.showErrorViaToast("An undefined error has occurred."),!1)}this.showErrorViaToast(c.error)}})}showInfoViaToast(){this.messageService.add({key:"tst",severity:"info",summary:"Info Message",detail:"PrimeNG rocks"})}showWarnViaToast(){this.messageService.add({key:"tst",severity:"warn",summary:"Warn Message",detail:"There are unsaved changes"})}showErrorViaToast(t){this.messageService.add({key:"tst",severity:"error",summary:"Error Message",detail:t})}showSuccessViaToast(){this.messageService.add({key:"tst",severity:"success",summary:"Success Message",detail:"Message sent"})}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.sBO),e.Y36(v),e.Y36(y.G),e.Y36(p.eN),e.Y36(d.ez))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-chat-box"]],inputs:{user:"user"},features:[e._Bn([d.YP,d.ez])],decls:25,vars:5,consts:[[1,"flex","flex-column","h-full"],[1,"flex","align-items-center","border-bottom-1","surface-border","p-3","lg:p-6"],[1,"relative","flex","align-items-center","mr-3"],["src","","alt","user.name",1,"w-4rem","h-4rem","border-circle","shadow-4"],[1,"w-1rem","h-1rem","border-circle","border-2","surface-border","absolute","bottom-0","right-0"],[1,"mr-2"],[1,"text-900","font-semibold","block"],[1,"text-700"],[1,"flex","align-items-center","ml-auto"],["pButton","","pRipple","","type","button","icon","pi pi-phone",1,"p-button-rounded","p-button-outlined","p-button-secondary","mr-3"],["pButton","","pRipple","","type","button","icon","pi pi-ellipsis-v",1,"p-button-rounded","p-button-outlined","p-button-secondary"],[1,"p-3","md:px-4","lg:px-6","lg:py-4","mt-2","overflow-y-auto",2,"max-height","53vh",3,"scrollTop"],["chatWindow",""],[4,"ngFor","ngForOf","ngForTrackBy"],[1,"p-3","md:p-4","lg:p-6","flex","flex-column","sm:flex-row","align-items-center","mt-auto","border-top-1","surface-border","gap-3"],["id","message","type","text","pInputText","","placeholder","Type a message",1,"flex-1","w-full","sm:w-auto","border-round",3,"ngModel","ngModelChange","keydown.enter"],[1,"flex","w-full","sm:w-auto","gap-3"],["pRipple","",1,"p-button","p-button-secondary","w-full","sm:w-auto","justify-content-center","text-xl"],["pButton","","pRipple","","label","Send","icon","pi pi-send",1,"w-full","sm:w-auto",3,"click"],["styleClass","w-full sm:w-30rem"],["op",""],["pTemplate",""],["class","grid grid-nogutter mb-4",4,"ngIf"],[1,"grid","grid-nogutter","mb-4"],[1,"mr-3","mt-1"],["src","","alt","user.name",1,"w-3rem","h-3rem","border-circle","shadow-4"],[1,"col","mt-3"],[1,"text-900","font-semibold","mb-3"],[1,"text-700","inline-block","font-medium","border-1","surface-border","p-3","white-space-normal","border-round",2,"word-break","break-word","max-width","80%"],[1,"text-700","mt-3"],[1,"pi","pi-check","ml-2","text-green-400"],[1,"col","mt-3","text-right"],[1,"inline-block","text-left","font-medium","border-1","surface-border","bg-primary-100","text-primary-900","p-3","white-space-normal","border-round",2,"word-break","break-word","max-width","80%"],["pButton","","pRipple","","type","button","class","p-2 p-button-text text-2xl",3,"label","click",4,"ngFor","ngForOf"],["pButton","","pRipple","","type","button",1,"p-2","p-button-text","text-2xl",3,"label","click"]],template:function(t,s){if(1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2),e._UZ(3,"img",3)(4,"span",4),e.qZA(),e.TgZ(5,"div",5)(6,"span",6),e._uU(7),e.qZA(),e.TgZ(8,"span",7),e._uU(9,"Last active 1 hour ago"),e.qZA()(),e.TgZ(10,"div",8),e._UZ(11,"button",9)(12,"button",10),e.qZA()(),e.TgZ(13,"div",11,12),e.YNc(15,V,3,2,"div",13),e.qZA(),e.TgZ(16,"div",14)(17,"input",15),e.NdJ("ngModelChange",function(r){return s.textContent=r})("keydown.enter",function(){return s.sendMessage()}),e.qZA(),e.TgZ(18,"div",16)(19,"button",17),e._uU(20,"\u{1f600}"),e.qZA(),e.TgZ(21,"button",18),e.NdJ("click",function(){return s.sendMessage()}),e.qZA()()()(),e.TgZ(22,"p-overlayPanel",19,20),e.YNc(24,H,1,1,"ng-template",21),e.qZA()),2&t){const o=e.MAs(14);e.xp6(7),e.Oqu(s.xetaperson.name),e.xp6(6),e.Q6J("scrollTop",o.scrollHeight),e.xp6(2),e.Q6J("ngForOf",s.messageList)("ngForTrackBy",s.trackByFn),e.xp6(2),e.Q6J("ngModel",s.textContent)}},dependencies:[h.sg,h.O5,x.o,C.Hq,d.jx,g.Fj,g.JJ,g.On,J],encapsulation:2,changeDetection:0}),n})();const Q=function(n,i){return{"md:block":n,hidden:i}},W=function(n){return{hidden:n}},X=[{path:"",component:(()=>{class n{constructor(t,s){this.chatService=t,this.eventService=s,this.hideSidebar=!0,this.hideChatBox=!1}ngOnInit(){this.eventService.on("MessageClicked",t=>{console.log("IN MESSAGES"),this.hideSidebar=!0,this.hideChatBox=!1})}ngOnDestroy(){}toggleChat(){this.hideSidebar=!1,this.hideChatBox=!0}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(v),e.Y36(y.G))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-messages"]],decls:8,vars:7,consts:[[1,"w-full"],["pButton","",1,"md:hidden","mb-2",3,"click"],[1,"flex","flex-column","md:flex-row","gap-5",2,"min-height","81vh"],[1,"md:w-25rem","card","p-0","md:block",3,"ngClass"],[1,"flex-1","card","p-0",3,"ngClass"]],template:function(t,s){1&t&&(e.TgZ(0,"div",0)(1,"button",1),e.NdJ("click",function(){return s.toggleChat()}),e._uU(2,"Back"),e.qZA()(),e.TgZ(3,"div",2)(4,"div",3),e._UZ(5,"app-chat-sidebar"),e.qZA(),e.TgZ(6,"div",4),e._UZ(7,"app-chat-box"),e.qZA()()),2&t&&(e.xp6(4),e.Q6J("ngClass",e.WLB(2,Q,s.hideSidebar,s.hideSidebar)),e.xp6(2),e.Q6J("ngClass",e.VKq(5,W,s.hideChatBox)))},dependencies:[h.mk,C.Hq,P,q]}),n})()}];let K=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[T.Bz.forChild(X),T.Bz]}),n})();var $=l(47),ee=l(1167),te=l(2453),ne=l(7932);let se=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({providers:[v],imports:[h.ez,K,x.j,C.hJ,$.U$,ee.KZ,g.u5,te.EV,g.UX,ne.L,N]}),n})()}}]);